<html>
<head>
<title>Investment Property Calculator</title>
<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
<meta name="HandheldFriendly" content="true"/>
<meta name="MobileOptimized" content="width" />
<link rel="stylesheet" type="text/css" href="../common/style.css" />
<style>
input{
text-align:right;
width:100%;
}
#rating{display:block;width:100%;}
table{width:100%;}
#t1 td:nth-child(1){min-width:200px;}
#t2 td:nth-child(1){width:180px;}
#t2 td:nth-child(2){text-align:center;}
</style>
<script type='text/javascript' src='../common/jquery-min.js'></script>
<script>
var config = {
	inputs: [
		{name:"house", label:"Property Value ($,000)", init:'0', multiplier:1000},
		{name:"rent", label:"Rent Value ($/wk)", init:'0', multiplier:52},
		{name:"strata", label:"Strata ($/qtr)", init:'0', multiplier:-4},
		{name:"water", label:"Water ($/qtr)", init:'0', multiplier:-4},
		{name:"council", label:"Council ($/qtr)", init:'0', multiplier:-4},
		{name:"size", label:"Size (m&sup2;)", init:'0', multiplier:1}
	],
	outputs: [
		{name:"factor", label:"Ratio", init:'0.0'},
		{name:"rating", label:"Rating", init:'-'},
		{name:"percent", label:"Return Percentage", init:'0.0%'},
		{name:"valpersqm", label:"Cost ($/m&sup2;)", init:'0.0'}
	]
}
$(document).ready(function(){
	build('inputs', config.inputs, true)
	build('outputs', config.outputs, false)
	$('#house').focus()
})
function build(tableId, fields, boolInputs){
	var table = $('#'+tableId)
	$.each(fields, function(idx, input){
		var tr = $('<tr>').appendTo(table)
		tr.append($('<td>').append($('<label>').html(input.label)))
		if (boolInputs){
			tr.append($('<td>').append(
				$('<input>').attr('id',input.name).attr('type','number').val(input.init).change(recalc).keyup(recalc)
			))
		} else {
			tr.append($('<td>').append($('<label>').attr('id',input.name).html(input.init)))
		}
	})
}
function recalc(){
	var inv = []
	$.each(config.inputs, function(idx, input){
		inv[input.name] = $('#'+input.name).val() * config.inputs[idx].multiplier
	})
	var outgoingsAndIncomings = inv.rent+inv.strata+inv.council+inv.water
	var factor = (inv.house/outgoingsAndIncomings).toFixed(2)
	var percent = (outgoingsAndIncomings/inv.house*100).toFixed(2)
	$('#factor').html(factor)
	$('#rating').html(factor < 10 ? "Very Good" : factor < 15 ? "Good" : factor < 20 ? "Average" : "Poor")
	$('#rating').css('background-color',factor < 10 ? "green" : factor < 15 ? "yellow" : factor < 20 ? "orange" : "red")
	$('#percent').html(percent + "%")
	$('#valpersqm').html((inv.house/inv.size).toFixed(2))
}
</script>
</head>
<body>
<label id="h1">Investment Property Calculator</label>
<table id="inputs" />
<table id="outputs" />
</body></html>
